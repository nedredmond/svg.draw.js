/*! @svgdotjs/svg.draw.js v3.0.2 MIT*/;
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(require("@svgdotjs/svg.js")):"function"==typeof define&&define.amd?define(["@svgdotjs/svg.js"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).SVG)}(this,(function(t){"use strict";var i=Object.defineProperty,s=(t,s,e)=>((t,s,e)=>s in t?i(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e)(t,"symbol"!=typeof s?s+"":s,e);const e={NAME:"circle",init:function(){var t=this.startPoint;this.el.attr({cx:t.x,cy:t.y,r:1})},calc:function(t){var i=this.transformPoint(t.clientX,t.clientY),s={cx:this.startPoint.x,cy:this.startPoint.y,r:Math.sqrt((i.x-this.startPoint.x)*(i.x-this.startPoint.x)+(i.y-this.startPoint.y)*(i.y-this.startPoint.y))};this.snapToGrid(s),this.el.attr(s)}},n={NAME:"ellipse",init:function(){var t=this.startPoint;this.el.attr({cx:t.x,cy:t.y,rx:1,ry:1})},calc:function(t){var i=this.transformPoint(t.clientX,t.clientY),s={cx:this.startPoint.x,cy:this.startPoint.y,rx:Math.abs(i.x-this.startPoint.x),ry:Math.abs(i.y-this.startPoint.y)};this.snapToGrid(s),this.el.attr(s)}},r={NAME:"line polyline polygon",init:function(){this.set=[];var t=this.startPoint,i=[[t.x,t.y],[t.x,t.y]];this.el.plot(i),this.options.drawCircles&&this.drawCircles()},calc:function(t){var i=this.el.array().valueOf();if(i.pop(),t){var s=this.transformPoint(t.clientX,t.clientY);i.push(this.snapToGrid([s.x,s.y]))}this.el.plot(i),this.options.drawCircles?this.drawCircles():(this.set.forEach((t=>t.remove())),this.set=[])},point:function(t){if(this.el.type.indexOf("poly")>-1){var i=this.transformPoint(t.clientX,t.clientY),s=this.el.array().valueOf();return s.push(this.snapToGrid([i.x,i.y])),this.el.plot(s),this.options.drawCircles&&this.drawCircles(),void this.el.fire("drawpoint",{event:t,p:{x:i.x,y:i.y},m:this.m})}this.stop(t)},clean:function(){this.set.forEach((t=>t.remove())),this.set=[],delete this.set},drawCircles:function(){var t=this.el.array().valueOf();this.set.forEach((t=>t.remove())),this.set=[];for(var i=0;i<t.length;++i){this.p.x=t[i][0],this.p.y=t[i][1];var s=this.p.matrixTransform(this.parent.node.getScreenCTM().inverse().multiply(this.el.node.getScreenCTM()));this.set.push(this.parent.circle(5).stroke({width:1}).fill("#ccc").center(s.x,s.y))}},undo:function(){this.set.length&&(this.set.splice(-2,1)[0].remove(),this.el.array().splice(-2,1),this.el.plot(this.el.array()),this.el.fire("undopoint"))}},o={NAME:"rect image",init:function(){var t=this.startPoint;this.el.attr({x:t.x,y:t.y,height:0,width:0})},calc:function(t){var i={x:this.startPoint.x,y:this.startPoint.y},s=this.transformPoint(t.clientX,t.clientY);i.width=s.x-i.x,i.height=s.y-i.y,this.snapToGrid(i),i.width<0&&(i.x=i.x+i.width,i.width=-i.width),i.height<0&&(i.y=i.y+i.height,i.height=-i.height),this.el.attr(i)}},a=class i{constructor(t,s,e){t.remember("_paintHandler",this),this.el=t;var n=this,r=this.getPlugin();this.parent=t.root(),this.p=this.parent.node.createSVGPoint(),this.m=null,this.startPoint=null,this.lastUpdateCall=null,this.options={},this.set=[];for(const o in i.defaults)this.options[o]=i.defaults[o],void 0!==e[o]&&(this.options[o]=e[o]);r.point&&(r.pointPlugin=r.point,delete r.point);for(const i in r)this[i]=r[i];s||this.parent.on("click.draw",(function(t){n.start(t)}))}transformPoint(t,i){return this.p.x=t-(this.offset.x-window.pageXOffset),this.p.y=i-(this.offset.y-window.pageYOffset),this.p.matrixTransform(this.m)}start(i){var s=this;this.m=this.el.node.getScreenCTM().inverse(),this.offset={x:window.pageXOffset,y:window.pageYOffset},this.options.snapToGrid*=Math.sqrt(this.m.a*this.m.a+this.m.b*this.m.b),this.startPoint=this.snapToGrid(this.transformPoint(i.clientX,i.clientY)),this.init&&this.init(i),this.el.fire("drawstart",{event:i,p:this.p,m:this.m}),t.on(window,"pointermove.draw",(function(t){s.update(t)})),this.start=this.point}point(t){return this.point!==this.start?this.start(t):this.pointPlugin?this.pointPlugin(t):void this.stop(t)}stop(i){i&&this.update(i),this.clean&&this.clean(),t.off(window,"pointermove.draw"),this.parent.off("click.draw"),this.el.forget("_paintHandler"),this.el.draw=function(){},this.el.fire("drawstop")}update(t){!t&&this.lastUpdateCall&&(t=this.lastUpdateCall),this.lastUpdateCall=t,this.m=this.el.node.getScreenCTM().inverse(),this.calc(t),this.el.fire("drawupdate",{event:t,p:this.p,m:this.m})}done(){this.calc(),this.stop(),this.el.fire("drawdone")}cancel(){this.stop(),this.el.remove(),this.el.fire("drawcancel")}snapToGrid(t){var i=null;if(t.length)return i=[t[0]%this.options.snapToGrid,t[1]%this.options.snapToGrid],t[0]-=i[0]<this.options.snapToGrid/2?i[0]:i[0]-this.options.snapToGrid,t[1]-=i[1]<this.options.snapToGrid/2?i[1]:i[1]-this.options.snapToGrid,t;for(var s in t)i=t[s]%this.options.snapToGrid,t[s]-=(i<this.options.snapToGrid/2?i:i-this.options.snapToGrid)+(i<0?this.options.snapToGrid:0);return t}param(t,s){this.options[t]=null===s?i.defaults[t]:s,this.update()}getPlugin(){return i.plugins[this.el.type]}static extend(t,s){var e={};for(var n in"string"==typeof t?e[t]=s:e=t,e){var r=n.trim().split(/\s+/);for(var o in r)i.plugins[r[o]]=e[n]}}};s(a,"defaults",{snapToGrid:1,drawCircles:!0}),s(a,"plugins",{});let h=a;t.extend(t.Element,{draw:function(t,i,s){t instanceof Event||"string"==typeof t||(i=t,t=null);var e=this.remember("_paintHandler")||new h(this,t,i||{});return t instanceof Event&&e.start(t),e[t]&&e[t](i,s),this}}),h.extend(o.NAME,o),h.extend(r.NAME,r),h.extend(n.NAME,n),h.extend(e.NAME,e)}));
//# sourceMappingURL=svg.draw.umd.cjs.map
